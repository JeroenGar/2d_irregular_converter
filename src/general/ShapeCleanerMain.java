package general;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.reflect.TypeToken;
import com.jsevy.jdxf.DXFDocument;
import com.jsevy.jdxf.DXFGraphics;
import json.Point;
import json.Shape;
import json.Zone;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.util.List;
import java.util.Map;

public class ShapeCleanerMain {
    public static void main(String[] args) throws IOException {
        Gson gson = new GsonBuilder().create();

        String referenceShapeString = "[{\"x\":107,\"y\":449},{\"x\":104,\"y\":448},{\"x\":101,\"y\":447},{\"x\":98,\"y\":445},{\"x\":96,\"y\":443},{\"x\":96,\"y\":440},{\"x\":96,\"y\":436},{\"x\":96,\"y\":431},{\"x\":95,\"y\":427},{\"x\":95,\"y\":423},{\"x\":95,\"y\":418},{\"x\":95,\"y\":413},{\"x\":95,\"y\":409},{\"x\":95,\"y\":404},{\"x\":95,\"y\":400},{\"x\":95,\"y\":395},{\"x\":95,\"y\":391},{\"x\":95,\"y\":386},{\"x\":95,\"y\":381},{\"x\":95,\"y\":376},{\"x\":94,\"y\":372},{\"x\":94,\"y\":367},{\"x\":94,\"y\":362},{\"x\":93,\"y\":357},{\"x\":93,\"y\":352},{\"x\":92,\"y\":348},{\"x\":92,\"y\":343},{\"x\":91,\"y\":338},{\"x\":91,\"y\":333},{\"x\":90,\"y\":328},{\"x\":90,\"y\":324},{\"x\":89,\"y\":319},{\"x\":88,\"y\":314},{\"x\":88,\"y\":310},{\"x\":87,\"y\":305},{\"x\":86,\"y\":301},{\"x\":85,\"y\":296},{\"x\":85,\"y\":291},{\"x\":84,\"y\":287},{\"x\":83,\"y\":282},{\"x\":82,\"y\":278},{\"x\":81,\"y\":273},{\"x\":80,\"y\":268},{\"x\":80,\"y\":264},{\"x\":79,\"y\":259},{\"x\":78,\"y\":254},{\"x\":77,\"y\":250},{\"x\":76,\"y\":245},{\"x\":75,\"y\":241},{\"x\":74,\"y\":236},{\"x\":73,\"y\":231},{\"x\":72,\"y\":227},{\"x\":71,\"y\":222},{\"x\":70,\"y\":217},{\"x\":69,\"y\":213},{\"x\":68,\"y\":208},{\"x\":67,\"y\":204},{\"x\":66,\"y\":199},{\"x\":65,\"y\":194},{\"x\":63,\"y\":190},{\"x\":62,\"y\":185},{\"x\":61,\"y\":181},{\"x\":60,\"y\":176},{\"x\":58,\"y\":172},{\"x\":57,\"y\":167},{\"x\":55,\"y\":163},{\"x\":54,\"y\":158},{\"x\":53,\"y\":154},{\"x\":51,\"y\":149},{\"x\":50,\"y\":145},{\"x\":48,\"y\":140},{\"x\":46,\"y\":136},{\"x\":45,\"y\":131},{\"x\":43,\"y\":127},{\"x\":41,\"y\":122},{\"x\":40,\"y\":117},{\"x\":38,\"y\":113},{\"x\":36,\"y\":108},{\"x\":35,\"y\":103},{\"x\":33,\"y\":99},{\"x\":31,\"y\":94},{\"x\":29,\"y\":89},{\"x\":28,\"y\":85},{\"x\":26,\"y\":80},{\"x\":24,\"y\":76},{\"x\":23,\"y\":71},{\"x\":21,\"y\":67},{\"x\":19,\"y\":63},{\"x\":18,\"y\":58},{\"x\":16,\"y\":54},{\"x\":15,\"y\":49},{\"x\":13,\"y\":45},{\"x\":11,\"y\":40},{\"x\":10,\"y\":36},{\"x\":8,\"y\":31},{\"x\":7,\"y\":28},{\"x\":5,\"y\":24},{\"x\":4,\"y\":20},{\"x\":3,\"y\":16},{\"x\":1,\"y\":12},{\"x\":0,\"y\":9},{\"x\":0,\"y\":6},{\"x\":0,\"y\":1},{\"x\":2,\"y\":0},{\"x\":5,\"y\":0},{\"x\":8,\"y\":0},{\"x\":11,\"y\":0},{\"x\":588,\"y\":0},{\"x\":592,\"y\":0},{\"x\":596,\"y\":0},{\"x\":600,\"y\":0},{\"x\":602,\"y\":2},{\"x\":603,\"y\":5},{\"x\":604,\"y\":8},{\"x\":605,\"y\":10},{\"x\":606,\"y\":15},{\"x\":608,\"y\":19},{\"x\":609,\"y\":24},{\"x\":611,\"y\":28},{\"x\":612,\"y\":32},{\"x\":613,\"y\":37},{\"x\":615,\"y\":41},{\"x\":616,\"y\":46},{\"x\":618,\"y\":50},{\"x\":619,\"y\":54},{\"x\":620,\"y\":59},{\"x\":622,\"y\":63},{\"x\":623,\"y\":68},{\"x\":624,\"y\":72},{\"x\":625,\"y\":77},{\"x\":627,\"y\":81},{\"x\":628,\"y\":86},{\"x\":629,\"y\":90},{\"x\":630,\"y\":95},{\"x\":631,\"y\":99},{\"x\":632,\"y\":104},{\"x\":633,\"y\":109},{\"x\":634,\"y\":113},{\"x\":635,\"y\":118},{\"x\":636,\"y\":122},{\"x\":637,\"y\":127},{\"x\":637,\"y\":132},{\"x\":638,\"y\":136},{\"x\":639,\"y\":141},{\"x\":640,\"y\":146},{\"x\":640,\"y\":150},{\"x\":641,\"y\":155},{\"x\":641,\"y\":160},{\"x\":642,\"y\":165},{\"x\":642,\"y\":169},{\"x\":643,\"y\":174},{\"x\":643,\"y\":179},{\"x\":644,\"y\":183},{\"x\":644,\"y\":188},{\"x\":644,\"y\":193},{\"x\":645,\"y\":198},{\"x\":645,\"y\":202},{\"x\":645,\"y\":207},{\"x\":645,\"y\":212},{\"x\":645,\"y\":217},{\"x\":646,\"y\":222},{\"x\":646,\"y\":227},{\"x\":646,\"y\":232},{\"x\":646,\"y\":237},{\"x\":646,\"y\":241},{\"x\":646,\"y\":246},{\"x\":646,\"y\":251},{\"x\":645,\"y\":256},{\"x\":645,\"y\":261},{\"x\":645,\"y\":266},{\"x\":645,\"y\":271},{\"x\":645,\"y\":276},{\"x\":644,\"y\":281},{\"x\":644,\"y\":286},{\"x\":644,\"y\":291},{\"x\":643,\"y\":295},{\"x\":643,\"y\":300},{\"x\":642,\"y\":305},{\"x\":642,\"y\":310},{\"x\":641,\"y\":314},{\"x\":640,\"y\":319},{\"x\":640,\"y\":324},{\"x\":639,\"y\":328},{\"x\":638,\"y\":333},{\"x\":638,\"y\":337},{\"x\":637,\"y\":342},{\"x\":636,\"y\":347},{\"x\":635,\"y\":351},{\"x\":634,\"y\":356},{\"x\":633,\"y\":361},{\"x\":632,\"y\":365},{\"x\":631,\"y\":370},{\"x\":630,\"y\":375},{\"x\":629,\"y\":379},{\"x\":628,\"y\":384},{\"x\":627,\"y\":389},{\"x\":626,\"y\":394},{\"x\":625,\"y\":398},{\"x\":623,\"y\":403},{\"x\":622,\"y\":408},{\"x\":621,\"y\":412},{\"x\":619,\"y\":417},{\"x\":618,\"y\":422},{\"x\":617,\"y\":426},{\"x\":615,\"y\":431},{\"x\":614,\"y\":436},{\"x\":613,\"y\":440},{\"x\":611,\"y\":445},{\"x\":610,\"y\":450},{\"x\":608,\"y\":455},{\"x\":607,\"y\":459},{\"x\":605,\"y\":464},{\"x\":604,\"y\":469},{\"x\":602,\"y\":473},{\"x\":601,\"y\":478},{\"x\":599,\"y\":483},{\"x\":597,\"y\":487},{\"x\":596,\"y\":492},{\"x\":594,\"y\":497},{\"x\":592,\"y\":501},{\"x\":590,\"y\":506},{\"x\":589,\"y\":510},{\"x\":587,\"y\":515},{\"x\":585,\"y\":519},{\"x\":583,\"y\":524},{\"x\":581,\"y\":528},{\"x\":579,\"y\":533},{\"x\":577,\"y\":537},{\"x\":575,\"y\":542},{\"x\":573,\"y\":546},{\"x\":571,\"y\":551},{\"x\":107,\"y\":449}]";
        String originalShape1String = "[{\"x\":616,\"y\":42},{\"x\":618,\"y\":52},{\"x\":620,\"y\":56},{\"x\":621,\"y\":61},{\"x\":622,\"y\":65},{\"x\":624,\"y\":70},{\"x\":625,\"y\":74},{\"x\":626,\"y\":79},{\"x\":627,\"y\":83},{\"x\":629,\"y\":88},{\"x\":630,\"y\":92},{\"x\":631,\"y\":97},{\"x\":632,\"y\":101},{\"x\":633,\"y\":106},{\"x\":634,\"y\":111},{\"x\":635,\"y\":115},{\"x\":636,\"y\":120},{\"x\":637,\"y\":124},{\"x\":637,\"y\":129},{\"x\":638,\"y\":134},{\"x\":639,\"y\":138},{\"x\":640,\"y\":143},{\"x\":640,\"y\":148},{\"x\":641,\"y\":152},{\"x\":642,\"y\":157},{\"x\":642,\"y\":162},{\"x\":643,\"y\":166},{\"x\":643,\"y\":171},{\"x\":644,\"y\":176},{\"x\":644,\"y\":181},{\"x\":645,\"y\":185},{\"x\":645,\"y\":190},{\"x\":645,\"y\":195},{\"x\":646,\"y\":200},{\"x\":646,\"y\":204},{\"x\":646,\"y\":209},{\"x\":646,\"y\":214},{\"x\":646,\"y\":219},{\"x\":646,\"y\":224},{\"x\":647,\"y\":229},{\"x\":647,\"y\":234},{\"x\":647,\"y\":239},{\"x\":647,\"y\":243},{\"x\":647,\"y\":248},{\"x\":646,\"y\":253},{\"x\":646,\"y\":258},{\"x\":646,\"y\":263},{\"x\":646,\"y\":268},{\"x\":646,\"y\":273},{\"x\":645,\"y\":278},{\"x\":645,\"y\":283},{\"x\":645,\"y\":288},{\"x\":644,\"y\":293},{\"x\":644,\"y\":297},{\"x\":643,\"y\":302},{\"x\":643,\"y\":307},{\"x\":642,\"y\":312},{\"x\":642,\"y\":316},{\"x\":641,\"y\":321},{\"x\":641,\"y\":326},{\"x\":640,\"y\":330},{\"x\":639,\"y\":335},{\"x\":639,\"y\":339},{\"x\":638,\"y\":344},{\"x\":637,\"y\":349},{\"x\":636,\"y\":353},{\"x\":635,\"y\":358},{\"x\":634,\"y\":363},{\"x\":633,\"y\":367},{\"x\":632,\"y\":372},{\"x\":631,\"y\":377},{\"x\":630,\"y\":381},{\"x\":629,\"y\":386},{\"x\":628,\"y\":391},{\"x\":627,\"y\":395},{\"x\":625,\"y\":400},{\"x\":624,\"y\":405},{\"x\":623,\"y\":410},{\"x\":622,\"y\":414},{\"x\":620,\"y\":419},{\"x\":619,\"y\":424},{\"x\":618,\"y\":428},{\"x\":616,\"y\":433},{\"x\":615,\"y\":438},{\"x\":614,\"y\":442},{\"x\":612,\"y\":447},{\"x\":611,\"y\":452},{\"x\":609,\"y\":457},{\"x\":608,\"y\":461},{\"x\":606,\"y\":466},{\"x\":605,\"y\":471},{\"x\":603,\"y\":475},{\"x\":602,\"y\":480},{\"x\":600,\"y\":485},{\"x\":598,\"y\":489},{\"x\":597,\"y\":494},{\"x\":595,\"y\":499},{\"x\":593,\"y\":503},{\"x\":591,\"y\":508},{\"x\":589,\"y\":512},{\"x\":588,\"y\":517},{\"x\":586,\"y\":521},{\"x\":584,\"y\":526},{\"x\":582,\"y\":530},{\"x\":580,\"y\":535},{\"x\":578,\"y\":539},{\"x\":576,\"y\":544},{\"x\":574,\"y\":548},{\"x\":572,\"y\":553},{\"x\":108,\"y\":451},{\"x\":105,\"y\":450},{\"x\":102,\"y\":449},{\"x\":99,\"y\":447},{\"x\":97,\"y\":445},{\"x\":97,\"y\":442},{\"x\":97,\"y\":438},{\"x\":96,\"y\":433},{\"x\":96,\"y\":429},{\"x\":96,\"y\":425},{\"x\":96,\"y\":420},{\"x\":96,\"y\":415},{\"x\":96,\"y\":411},{\"x\":96,\"y\":406},{\"x\":96,\"y\":402},{\"x\":96,\"y\":397},{\"x\":96,\"y\":393},{\"x\":96,\"y\":388},{\"x\":96,\"y\":383},{\"x\":96,\"y\":378},{\"x\":95,\"y\":374},{\"x\":95,\"y\":369},{\"x\":95,\"y\":364},{\"x\":94,\"y\":359},{\"x\":94,\"y\":354},{\"x\":93,\"y\":350},{\"x\":93,\"y\":345},{\"x\":92,\"y\":340},{\"x\":92,\"y\":335},{\"x\":91,\"y\":330},{\"x\":90,\"y\":326},{\"x\":90,\"y\":321},{\"x\":89,\"y\":316},{\"x\":88,\"y\":312},{\"x\":88,\"y\":307},{\"x\":87,\"y\":303},{\"x\":86,\"y\":298},{\"x\":85,\"y\":293},{\"x\":85,\"y\":289},{\"x\":84,\"y\":284},{\"x\":83,\"y\":280},{\"x\":82,\"y\":275},{\"x\":81,\"y\":270},{\"x\":80,\"y\":266},{\"x\":80,\"y\":261},{\"x\":79,\"y\":256},{\"x\":78,\"y\":252},{\"x\":77,\"y\":247},{\"x\":76,\"y\":243},{\"x\":75,\"y\":238},{\"x\":74,\"y\":233},{\"x\":73,\"y\":229},{\"x\":72,\"y\":224},{\"x\":71,\"y\":219},{\"x\":70,\"y\":215},{\"x\":69,\"y\":210},{\"x\":68,\"y\":206},{\"x\":67,\"y\":201},{\"x\":66,\"y\":196},{\"x\":64,\"y\":192},{\"x\":63,\"y\":187},{\"x\":62,\"y\":183},{\"x\":60,\"y\":178},{\"x\":59,\"y\":174},{\"x\":58,\"y\":169},{\"x\":56,\"y\":165},{\"x\":55,\"y\":160},{\"x\":53,\"y\":156},{\"x\":52,\"y\":151},{\"x\":50,\"y\":147},{\"x\":49,\"y\":142},{\"x\":47,\"y\":138},{\"x\":46,\"y\":133},{\"x\":44,\"y\":128},{\"x\":42,\"y\":124},{\"x\":41,\"y\":119},{\"x\":39,\"y\":114},{\"x\":37,\"y\":110},{\"x\":35,\"y\":105},{\"x\":34,\"y\":101},{\"x\":32,\"y\":96},{\"x\":30,\"y\":91},{\"x\":28,\"y\":87},{\"x\":27,\"y\":82},{\"x\":25,\"y\":78},{\"x\":23,\"y\":73},{\"x\":22,\"y\":69},{\"x\":20,\"y\":64},{\"x\":19,\"y\":60},{\"x\":17,\"y\":56},{\"x\":15,\"y\":51},{\"x\":14,\"y\":47},{\"x\":12,\"y\":42},{\"x\":616,\"y\":42}]";

        String originalShape2String = "[{\"x\":591,\"y\":504},{\"x\":588,\"y\":512},{\"x\":586,\"y\":516},{\"x\":584,\"y\":521},{\"x\":582,\"y\":525},{\"x\":580,\"y\":530},{\"x\":578,\"y\":534},{\"x\":576,\"y\":539},{\"x\":574,\"y\":543},{\"x\":572,\"y\":548},{\"x\":570,\"y\":552},{\"x\":106,\"y\":450},{\"x\":103,\"y\":449},{\"x\":100,\"y\":448},{\"x\":98,\"y\":447},{\"x\":96,\"y\":445},{\"x\":95,\"y\":441},{\"x\":95,\"y\":437},{\"x\":95,\"y\":433},{\"x\":95,\"y\":429},{\"x\":95,\"y\":424},{\"x\":95,\"y\":420},{\"x\":95,\"y\":415},{\"x\":95,\"y\":410},{\"x\":95,\"y\":406},{\"x\":95,\"y\":401},{\"x\":95,\"y\":397},{\"x\":95,\"y\":392},{\"x\":95,\"y\":388},{\"x\":94,\"y\":383},{\"x\":94,\"y\":378},{\"x\":94,\"y\":373},{\"x\":94,\"y\":368},{\"x\":93,\"y\":363},{\"x\":93,\"y\":359},{\"x\":92,\"y\":354},{\"x\":92,\"y\":349},{\"x\":91,\"y\":344},{\"x\":91,\"y\":339},{\"x\":90,\"y\":335},{\"x\":90,\"y\":330},{\"x\":89,\"y\":325},{\"x\":88,\"y\":321},{\"x\":88,\"y\":316},{\"x\":87,\"y\":311},{\"x\":86,\"y\":307},{\"x\":86,\"y\":302},{\"x\":85,\"y\":298},{\"x\":84,\"y\":293},{\"x\":83,\"y\":288},{\"x\":82,\"y\":284},{\"x\":82,\"y\":279},{\"x\":81,\"y\":274},{\"x\":80,\"y\":270},{\"x\":79,\"y\":265},{\"x\":78,\"y\":261},{\"x\":77,\"y\":256},{\"x\":76,\"y\":251},{\"x\":76,\"y\":247},{\"x\":75,\"y\":242},{\"x\":74,\"y\":237},{\"x\":73,\"y\":233},{\"x\":72,\"y\":228},{\"x\":71,\"y\":224},{\"x\":70,\"y\":219},{\"x\":69,\"y\":214},{\"x\":68,\"y\":210},{\"x\":66,\"y\":205},{\"x\":65,\"y\":200},{\"x\":64,\"y\":196},{\"x\":63,\"y\":191},{\"x\":62,\"y\":187},{\"x\":60,\"y\":182},{\"x\":59,\"y\":178},{\"x\":58,\"y\":173},{\"x\":56,\"y\":169},{\"x\":55,\"y\":164},{\"x\":53,\"y\":160},{\"x\":52,\"y\":155},{\"x\":51,\"y\":151},{\"x\":49,\"y\":146},{\"x\":47,\"y\":142},{\"x\":46,\"y\":137},{\"x\":44,\"y\":133},{\"x\":43,\"y\":128},{\"x\":41,\"y\":123},{\"x\":39,\"y\":119},{\"x\":37,\"y\":114},{\"x\":36,\"y\":109},{\"x\":34,\"y\":105},{\"x\":32,\"y\":100},{\"x\":30,\"y\":95},{\"x\":29,\"y\":91},{\"x\":27,\"y\":86},{\"x\":25,\"y\":82},{\"x\":24,\"y\":77},{\"x\":22,\"y\":73},{\"x\":20,\"y\":68},{\"x\":19,\"y\":64},{\"x\":17,\"y\":60},{\"x\":16,\"y\":55},{\"x\":14,\"y\":51},{\"x\":12,\"y\":46},{\"x\":11,\"y\":42},{\"x\":11,\"y\":41},{\"x\":80,\"y\":41},{\"x\":90,\"y\":60},{\"x\":110,\"y\":120},{\"x\":126,\"y\":165},{\"x\":160,\"y\":300},{\"x\":173,\"y\":410},{\"x\":591,\"y\":504}]";

        Shape referenceShape = new Shape(gson.fromJson(referenceShapeString, new TypeToken<List<Point>>() {
        }.getType()));
        Shape originalShape1 = new Shape(gson.fromJson(originalShape1String, new TypeToken<List<Point>>() {
        }.getType()));
        Shape originalShape2 = new Shape(gson.fromJson(originalShape2String, new TypeToken<List<Point>>() {
        }.getType()));

        ShapeCleaner cleaner = new ShapeCleaner();
        Shape cleanedShape1 = cleaner.cleanSharedVertices(originalShape1, referenceShape, "testShape1");
        Shape cleanedShape2 = cleaner.cleanSharedVertices(originalShape2, referenceShape, "testShape2");

        writeFile(generateDXF(cleanedShape1), new File("cleanedShape1.dxf"));
        writeFile(generateDXF(cleanedShape2), new File("cleanedShape2.dxf"));

        System.out.println("done");

    }

    static DXFDocument generateDXF(Shape shape) {
        DXFDocument dxfDocument = new DXFDocument();
        DXFGraphics dxfGraphics = dxfDocument.getGraphics();

        shape.draw(dxfGraphics);



        return dxfDocument;
    }

    static void writeFile(DXFDocument dxf, File file) throws IOException {
        FileWriter fw = new FileWriter(file);
        fw.write(dxf.toDXFString());
        fw.close();
    }
}
